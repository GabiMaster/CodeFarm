<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CodeFarm API Demo</title>
    <style>
      :root{
        --bg: #161622;
        --surface: #1E1E2D;
        --primary: #3794FF;
        --text: #FFFFFF;
        --muted: #A1A1A9;
        --border: #23233A;
      }
      html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Arial,sans-serif}
      .wrap{display:flex;flex-direction:column;height:100vh}
      header{padding:18px 24px;border-bottom:1px solid rgba(255,255,255,0.04);display:flex;align-items:center;gap:16px}
      header h1{margin:0;font-size:18px}
      .main{display:flex;flex:1;overflow:hidden}
      .sidebar{width:360px;background:var(--surface);padding:16px;box-sizing:border-box;border-right:1px solid var(--border);overflow:auto}
      .content{flex:1;padding:16px;display:flex;flex-direction:column;gap:12px;overflow:auto}
      .group{margin-bottom:12px}
      .group h3{margin:0 0 8px 0;font-size:13px;color:var(--muted)}
      .endpoint{display:flex;align-items:center;gap:8px;padding:8px;border-radius:6px;background:rgba(255,255,255,0.02);margin-bottom:8px}
      .method{font-weight:700;padding:4px 8px;border-radius:6px;color:var(--text);font-size:12px}
      .method.GET{background:#0ea5a3}
      .method.POST{background:#2563eb}
      .method.PUT{background:#f59e0b}
      .method.DELETE{background:#ef4444}
      .ep-path{font-family:monospace;color:var(--text);font-size:13px;flex:1}
      button.call{background:var(--primary);border:none;color:#fff;padding:6px 10px;border-radius:6px;cursor:pointer}
      .panel{display:flex;gap:12px}
      .panel > div{flex:1}
      label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
      input[type=text],textarea{width:100%;padding:8px;border-radius:6px;border:1px solid var(--border);background:transparent;color:var(--text);box-sizing:border-box}
      textarea{height:200px;resize:vertical;font-family:monospace}
      pre{background:#0b0b12;padding:12px;border-radius:6px;color:#e6eef8;overflow:auto;max-height:400px}
      .footer{font-size:13px;color:var(--muted);padding:8px}
    </style>
  </head>
  <body>
    <div class="wrap">
      <header>
        <h1>CodeFarm — API Demo</h1>
        <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
          <label style="margin:0;display:flex;flex-direction:column;font-size:12px;color:var(--muted)">Base API URL
            <input id="baseUrl" type="text" placeholder="https://us-central1-.../api" value="" />
          </label>
          <button id="setBase" class="call">Usar</button>
          <label style="margin:0;display:flex;flex-direction:column;font-size:12px;color:var(--muted)">Authorization
            <input id="authToken" type="text" placeholder="Bearer &lt;token&gt;" />
          </label>
          <button id="saveToken" class="call">Guardar</button>
          <button id="clearToken" class="call" style="background:#666">Limpiar</button>
        </div>
      </header>

      <div class="main">
        <aside class="sidebar">
          <div class="group">
            <h3>Autenticación</h3>
            <div class="endpoint"><div class="method POST">POST</div><div class="ep-path">/auth/register</div><button class="call" data-path="/auth/register" data-method="POST">Probar</button></div>
            <div class="endpoint"><div class="method POST">POST</div><div class="ep-path">/auth/login</div><button class="call" data-path="/auth/login" data-method="POST">Probar</button></div>
            <div class="endpoint"><div class="method POST">POST</div><div class="ep-path">/auth/change-password</div><button class="call" data-path="/auth/change-password" data-method="POST">Probar</button></div>
          </div>

          <div class="group">
            <h3>Proyectos</h3>
            <div class="endpoint"><div class="method POST">POST</div><div class="ep-path">/projects</div><button class="call" data-path="/projects" data-method="POST">Probar</button></div>
            <div class="endpoint"><div class="method GET">GET</div><div class="ep-path">/projects/user/:userId</div><button class="call" data-path="/projects/user/{userId}" data-method="GET">Probar</button></div>
            <div class="endpoint"><div class="method GET">GET</div><div class="ep-path">/projects/:projectId</div><button class="call" data-path="/projects/{projectId}" data-method="GET">Probar</button></div>
            <div class="endpoint"><div class="method PUT">PUT</div><div class="ep-path">/projects/:projectId</div><button class="call" data-path="/projects/{projectId}" data-method="PUT">Probar</button></div>
            <div class="endpoint"><div class="method DELETE">DELETE</div><div class="ep-path">/projects/:projectId</div><button class="call" data-path="/projects/{projectId}" data-method="DELETE">Probar</button></div>
          </div>

          <div class="group">
            <h3>Archivos</h3>
            <div class="endpoint"><div class="method POST">POST</div><div class="ep-path">/files</div><button class="call" data-path="/files" data-method="POST">Probar</button></div>
            <div class="endpoint"><div class="method GET">GET</div><div class="ep-path">/files/project/:projectId</div><button class="call" data-path="/files/project/{projectId}" data-method="GET">Probar</button></div>
            <div class="endpoint"><div class="method PUT">PUT</div><div class="ep-path">/files/:fileId</div><button class="call" data-path="/files/{fileId}" data-method="PUT">Probar</button></div>
            <div class="endpoint"><div class="method DELETE">DELETE</div><div class="ep-path">/files/:fileId</div><button class="call" data-path="/files/{fileId}" data-method="DELETE">Probar</button></div>
          </div>

          <div class="group">
            <h3>Usuarios</h3>
            <div class="endpoint"><div class="method GET">GET</div><div class="ep-path">/users/:userId</div><button class="call" data-path="/users/{userId}" data-method="GET">Probar</button></div>
            <div class="endpoint"><div class="method PUT">PUT</div><div class="ep-path">/users/:userId</div><button class="call" data-path="/users/{userId}" data-method="PUT">Probar</button></div>
          </div>

          <div class="group">
            <h3>Notificaciones</h3>
            <div class="endpoint"><div class="method GET">GET</div><div class="ep-path">/notifications/:userId</div><button class="call" data-path="/notifications/{userId}" data-method="GET">Probar</button></div>
          </div>

          <div class="group">
            <h3>Colaboradores</h3>
            <div class="endpoint"><div class="method POST">POST</div><div class="ep-path">/collaborators</div><button class="call" data-path="/collaborators" data-method="POST">Probar</button></div>
            <div class="endpoint"><div class="method GET">GET</div><div class="ep-path">/collaborators/project/:projectId</div><button class="call" data-path="/collaborators/project/{projectId}" data-method="GET">Probar</button></div>
            <div class="endpoint"><div class="method PUT">PUT</div><div class="ep-path">/collaborators/:collaboratorId</div><button class="call" data-path="/collaborators/{collaboratorId}" data-method="PUT">Probar</button></div>
            <div class="endpoint"><div class="method DELETE">DELETE</div><div class="ep-path">/collaborators/:collaboratorId</div><button class="call" data-path="/collaborators/{collaboratorId}" data-method="DELETE">Probar</button></div>
            <div class="endpoint"><div class="method GET">GET</div><div class="ep-path">/collaborators/user/:userId</div><button class="call" data-path="/collaborators/user/{userId}" data-method="GET">Probar</button></div>
          </div>

          <div class="group">
            <h3>Ejecuciones</h3>
            <div class="endpoint"><div class="method POST">POST</div><div class="ep-path">/executions</div><button class="call" data-path="/executions" data-method="POST">Probar</button></div>
            <div class="endpoint"><div class="method GET">GET</div><div class="ep-path">/executions/:executionId</div><button class="call" data-path="/executions/{executionId}" data-method="GET">Probar</button></div>
            <div class="endpoint"><div class="method GET">GET</div><div class="ep-path">/executions/project/:projectId</div><button class="call" data-path="/executions/project/{projectId}" data-method="GET">Probar</button></div>
          </div>

          <div class="group">
            <h3>Comentarios</h3>
            <div class="endpoint"><div class="method POST">POST</div><div class="ep-path">/comments</div><button class="call" data-path="/comments" data-method="POST">Probar</button></div>
            <div class="endpoint"><div class="method GET">GET</div><div class="ep-path">/comments/file/:fileId</div><button class="call" data-path="/comments/file/{fileId}" data-method="GET">Probar</button></div>
            <div class="endpoint"><div class="method PUT">PUT</div><div class="ep-path">/comments/:commentId</div><button class="call" data-path="/comments/{commentId}" data-method="PUT">Probar</button></div>
            <div class="endpoint"><div class="method DELETE">DELETE</div><div class="ep-path">/comments/:commentId</div><button class="call" data-path="/comments/{commentId}" data-method="DELETE">Probar</button></div>
          </div>

          <div class="group">
            <h3>Versiones</h3>
            <div class="endpoint"><div class="method POST">POST</div><div class="ep-path">/versions</div><button class="call" data-path="/versions" data-method="POST">Probar</button></div>
            <div class="endpoint"><div class="method GET">GET</div><div class="ep-path">/versions/file/:fileId</div><button class="call" data-path="/versions/file/{fileId}" data-method="GET">Probar</button></div>
            <div class="endpoint"><div class="method POST">POST</div><div class="ep-path">/versions/:versionId/restore</div><button class="call" data-path="/versions/{versionId}/restore" data-method="POST">Probar</button></div>
          </div>
        </aside>

        <section class="content">
          <div class="panel">
            <div>
              <label>Path (rellene parámetros entre { } si aplica)</label>
              <input id="path" type="text" placeholder="/projects/{projectId}" />
            </div>
            <div>
              <label>Método</label>
              <input id="method" type="text" value="GET" />
            </div>
            <div style="width:140px;display:flex;flex-direction:column;gap:6px">
              <label>Enviar</label>
              <button id="sendBtn" class="call">Enviar</button>
              <button id="previewBtn" class="call" style="background:#444;margin-top:6px">Previsualizar payload</button>
            </div>
          </div>

          <div>
            <label>JSON Body (si aplica)</label>
            <textarea id="body" placeholder='{"key":"value"}'></textarea>
          </div>

          <div style="display:flex;gap:12px">
            <div style="flex:1">
              <label>Respuesta</label>
              <pre id="response">Esperando acción...</pre>
            </div>
            <div style="width:320px">
              <label>Console</label>
              <pre id="log">Registros de la demo</pre>
            </div>
          </div>

          <div style="margin-top:12px">
            <label>Payload enviado (final, tras normalizaciones)</label>
            <pre id="outgoing">Sin payload aún</pre>
            <div style="margin-top:6px;display:flex;gap:8px">
              <button id="copyPayload" class="call" style="background:#555">Copiar payload</button>
            </div>
          </div>

          <div class="footer">Consejo: ajusta la "Base API URL" para apuntar a la URL desplegada de la función (ej. https://us-central1-.../api) o al emulador local.</div>
        </section>
      </div>
    </div>

    <script src="./api-demo.js"></script>
  </body>
</html>
